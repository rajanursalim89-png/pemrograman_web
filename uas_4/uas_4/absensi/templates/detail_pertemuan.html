<h1>Detail Pertemuan</h1>

<p>Nama: {{p[1]}}</p>
<p>Tanggal: {{p[2]}}</p>
<p>Waktu: {{p[3]}} - {{p[4]}}</p>

<h2 style="color:blue;cursor:pointer" onclick="startScan()">
Mulai Presentasi
</h2>

<div id="reader" style="width:300px"></div>
<p id="status"></p>

<h3>Daftar Hadir</h3>
{% if not hadir %}
<p>Belum ada mahasiswa hadir</p>
{% endif %}
<ul>
{% for h in hadir %}
<li>{{h[0]}} - {{h[1]}}</li>
{% endfor %}
</ul>

<script src="/static/html5-qrcode.min.js"></script>
<script>
function startScan(){
    const html5QrCode = new Html5Qrcode("reader");
    html5QrCode.start(
        { facingMode: "environment" },
        { fps: 10, qrbox: 250 },
        qrCodeMessage => {
            fetch("/scan/{{p[0]}}/" + qrCodeMessage)
            .then(res => res.text())
            .then(msg => {
                document.getElementById("status").innerHTML = msg
                html5QrCode.stop()
            })
        }
    )
}
</script>
